<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reproductor 360</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>
    body { margin: 0; background: black; }
    #title {
      position: absolute;
      top: 10px; left: 0; right: 0;
      text-align: center;
      color: white;
      font-family: Arial, sans-serif;
      font-size: 20px;
      text-shadow: 1px 1px 5px black;
    }
  </style>
</head>
<body>
  <div id="title">Cargando video...</div>

  <a-scene loading-screen="dotsColor: #24CAFF; backgroundColor: black" vr-mode-ui="enabled: true">
    <a-assets>
      <video id="Protegamos lo irremplazable" 
             src="https://f005.backblazeb2.com/file/smartrabbit-videos/UICN+1+pase.mp4" 
             autoplay 
             loop 
             crossorigin="anonymous" 
             playsinline 
             webkit-playsinline 
             muted>
      </video>
    </a-assets>

    <!-- Esfera de video -->
    <a-videosphere src="#video360" rotation="0 -90 0"></a-videosphere>

    <!-- Cámara con control de giroscopio y touch -->
    <a-entity camera look-controls wasd-controls position="0 0 0"></a-entity>
  </a-scene>

  <script>
    // Actualiza el título con el nombre del video
    document.getElementById("title").textContent = "UICN- Mesoamerica";

    // iOS necesita permiso para giroscopio
    async function askMotionPermissions(){
      try {
        if (typeof DeviceMotionEvent !== "undefined" &&
            typeof DeviceMotionEvent.requestPermission === "function") {
          const resp = await DeviceMotionEvent.requestPermission();
          if (resp === "granted") console.log("✅ Giroscopio activado");
          else console.warn("⚠️ El usuario denegó permisos de giroscopio");
        }
      } catch (e) { console.error(e); }
    }

    document.body.addEventListener("click", askMotionPermissions, {once:true});
  </script>
</body>
</html>
